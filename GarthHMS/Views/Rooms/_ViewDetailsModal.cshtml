@model GarthHMS.Core.DTOs.Room.RoomResponseDto

<div class="room-details-enhanced">
    <!-- Header con color según estado -->
    <div class="details-header @GetHeaderClass(Model.Status) mb-4">
        <div class="row align-items-center">
            <div class="col-md-8">
                <h3 class="mb-0">
                    <i class="fas fa-door-open"></i> Habitación @Model.RoomNumber
                </h3>
                <p class="mb-0 mt-1 opacity-75">
                    <strong>@Model.RoomTypeCode</strong> - @Model.RoomTypeName
                </p>
            </div>
            <div class="col-md-4 text-end">
                <span class="@Model.StatusBadgeClass status-badge-large">
                    <i class="fas @Model.StatusIcon"></i>
                    @Model.StatusText
                </span>
            </div>
        </div>
    </div>

    <!-- Información Rápida - Cards con iconos -->
    <div class="row g-3 mb-4">
        <div class="col-md-3">
            <div class="info-card bg-primary-light">
                <i class="fas fa-layer-group card-icon text-primary"></i>
                <div class="card-content">
                    <small class="text-muted">Piso</small>
                    <h5 class="mb-0">@Model.FloorDisplay</h5>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="info-card bg-info-light">
                <i class="fas fa-bed card-icon text-info"></i>
                <div class="card-content">
                    <small class="text-muted">Tipo</small>
                    <h5 class="mb-0">@Model.RoomTypeCode</h5>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="info-card @(Model.IsOccupied ? "bg-danger-light" : "bg-success-light")">
                <i class="fas @(Model.IsOccupied ? "fa-user" : "fa-check-circle") card-icon @(Model.IsOccupied ? "text-danger" : "text-success")"></i>
                <div class="card-content">
                    <small class="text-muted">Ocupación</small>
                    <h5 class="mb-0">@(Model.IsOccupied ? "Ocupada" : "Libre")</h5>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="info-card @(Model.IsActive ? "bg-success-light" : "bg-secondary-light")">
                <i class="fas @(Model.IsActive ? "fa-check-circle" : "fa-ban") card-icon @(Model.IsActive ? "text-success" : "text-secondary")"></i>
                <div class="card-content">
                    <small class="text-muted">Estado</small>
                    <h5 class="mb-0">@(Model.IsActive ? "Activa" : "Inactiva")</h5>
                </div>
            </div>
        </div>
    </div>

    <!-- Timeline de Estado -->
    <div class="section-card mb-4">
        <div class="section-header bg-primary">
            <i class="fas fa-history"></i> Historial de Estado
        </div>
        <div class="section-body">
            <div class="timeline-item">
                <div class="timeline-marker @GetStatusColorClass(Model.Status)">
                    <i class="fas @Model.StatusIcon"></i>
                </div>
                <div class="timeline-content">
                    <strong>Estado Actual: @Model.StatusText</strong>
                    <br>
                    <small class="text-muted">
                        Actualizado el @Model.StatusChangedAt.ToString("dd/MM/yyyy") a las @Model.StatusChangedAt.ToString("HH:mm")
                    </small>
                </div>
            </div>
        </div>
    </div>

    <!-- Notas (si existen) -->
    @if (!string.IsNullOrEmpty(Model.Notes))
    {
        <div class="section-card mb-4">
            <div class="section-header bg-warning">
                <i class="fas fa-sticky-note"></i> Notas
            </div>
            <div class="section-body">
                <div class="alert alert-warning mb-0 d-flex align-items-start">
                    <i class="fas fa-info-circle me-2 mt-1"></i>
                    <div>@Model.Notes</div>
                </div>
            </div>
        </div>
    }

    <!-- Información de Auditoría -->
    <div class="section-card">
        <div class="section-header bg-secondary">
            <i class="fas fa-clock"></i> Información de Auditoría
        </div>
        <div class="section-body">
            <div class="row g-3">
                <div class="col-md-6">
                    <div class="audit-item">
                        <i class="fas fa-plus-circle text-success me-2"></i>
                        <div>
                            <small class="text-muted">Fecha de Creación</small>
                            <div><strong>@Model.CreatedAt.ToString("dd/MM/yyyy HH:mm")</strong></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="audit-item">
                        <i class="fas fa-edit text-primary me-2"></i>
                        <div>
                            <small class="text-muted">Última Actualización</small>
                            <div><strong>@Model.UpdatedAt.ToString("dd/MM/yyyy HH:mm")</strong></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="mt-4 text-end">
    <button type="button" class="btn btn-secondary" onclick="Swal.close()">
        <i class="fas fa-times"></i> Cerrar
    </button>
</div>

@functions {
    private string GetHeaderClass(GarthHMS.Core.Enums.RoomStatus status)
    {
        return status switch
        {
            GarthHMS.Core.Enums.RoomStatus.Available => "header-success",
            GarthHMS.Core.Enums.RoomStatus.Occupied => "header-danger",
            GarthHMS.Core.Enums.RoomStatus.Dirty => "header-warning",
            GarthHMS.Core.Enums.RoomStatus.Cleaning => "header-info",
            GarthHMS.Core.Enums.RoomStatus.Maintenance => "header-secondary",
            GarthHMS.Core.Enums.RoomStatus.Reserved => "header-primary",
            _ => "header-light"
        };
    }

    private string GetStatusColorClass(GarthHMS.Core.Enums.RoomStatus status)
    {
        return status switch
        {
            GarthHMS.Core.Enums.RoomStatus.Available => "bg-success",
            GarthHMS.Core.Enums.RoomStatus.Occupied => "bg-danger",
            GarthHMS.Core.Enums.RoomStatus.Dirty => "bg-warning",
            GarthHMS.Core.Enums.RoomStatus.Cleaning => "bg-info",
            GarthHMS.Core.Enums.RoomStatus.Maintenance => "bg-secondary",
            GarthHMS.Core.Enums.RoomStatus.Reserved => "bg-primary",
            _ => "bg-light"
        };
    }
}