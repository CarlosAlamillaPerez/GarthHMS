@model GarthHMS.Core.DTOs.User.ChangePasswordDto

<form id="changePasswordForm" class="text-start">
    <input type="hidden" name="UserId" value="@Model.UserId" />

    <div class="alert alert-info mb-4">
        <i class="fas fa-user-shield"></i>
        <strong>Cambiar contraseña para:</strong> @ViewBag.UserFullName
    </div>

    <!-- Contraseña Actual -->
    <div class="mb-3">
        <label for="currentPassword" class="form-label d-flex align-items-center justify-content-left">
            Contraseña Actual <span class="text-danger">*</span>
        </label>
        <div class="input-group">
            <input type="password"
                   class="form-control"
                   id="currentPassword"
                   name="CurrentPassword"
                   placeholder="Ingresa la contraseña actual"
                   required>
            <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('currentPassword')">
                <i class="fas fa-eye"></i>
            </button>
        </div>
    </div>

    <!-- Nueva Contraseña -->
    <div class="mb-3">
        <label for="newPassword" class="form-label d-flex align-items-center justify-content-left">
            Nueva Contraseña <span class="text-danger">*</span>
        </label>
        <div class="input-group">
            <input type="password"
                   class="form-control"
                   id="newPassword"
                   name="NewPassword"
                   placeholder="Mínimo 6 caracteres"
                   required
                   minlength="6"
                   maxlength="100">
            <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('newPassword')">
                <i class="fas fa-eye"></i>
            </button>
        </div>
        <div class="form-text">
            <i class="fas fa-info-circle"></i> La contraseña debe tener al menos 6 caracteres
        </div>
    </div>

    <!-- Confirmar Contraseña -->
    <div class="mb-3">
        <label for="confirmPassword" class="form-label d-flex align-items-center justify-content-left">
            Confirmar Nueva Contraseña <span class="text-danger">*</span>
        </label>
        <div class="input-group">
            <input type="password"
                   class="form-control"
                   id="confirmPassword"
                   name="ConfirmPassword"
                   placeholder="Repite la nueva contraseña"
                   required
                   minlength="6"
                   maxlength="100">
            <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('confirmPassword')">
                <i class="fas fa-eye"></i>
            </button>
        </div>
    </div>

    <div class="alert alert-warning">
        <i class="fas fa-exclamation-triangle"></i>
        <strong>Importante:</strong> Asegúrate de recordar la nueva contraseña. No podrás recuperarla después.
    </div>

    <!-- Botones -->
    <div class="mt-4 text-end">
        <button type="button" class="btn btn-secondary" onclick="Swal.close()">
            <i class="fas fa-times"></i> Cancelar
        </button>
        <button type="submit" class="btn btn-primary">
            <i class="fas fa-key"></i> Cambiar Contraseña
        </button>
    </div>
</form>

<script>
    function togglePassword(fieldId) {
        const field = document.getElementById(fieldId);
        const button = field.nextElementSibling;
        const icon = button.querySelector('i');

        if (field.type === 'password') {
            field.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            field.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    }
</script>